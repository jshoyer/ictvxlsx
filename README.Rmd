
library(readxl)
library(dplyr)

msl2023 <-
  read_excel("ICTV_Master_Species_List_2023_MSL39.v1.xlsx",
             col_types = "text",
             sheet = 2, .name_repair = "universal")


## Top down: ######################################################################
monodna <- filter(msl2023, Realm == "Monodnaviria") |>
    select(-Realm, -Subrealm)

gemini <- filter(msl2023, Family %in% c("Geminiviridae",
                                        "Alphasatellitidae",
                                        "Tolecusatellitidae")) |>
    select(-Kingdom, -Subkingdom, -Phylum, -Subphylum,
           -Class,   -Subclass,   -Order,  -Suborder,
           -Realm, -Subrealm)

with(gemini, table(Family, useNA = "always"))

with(gemini, table(Subfamily, useNA = "always"))
with(gemini, table(Subgenus, useNA = "always"))

with(gemini, table(Last.Change, useNA = "always"))

#' Inconsistent:
with(gemini, table(Genome.Composition, useNA = "always"))
with(gemini, table(Genome.Composition, Genus, useNA = "ifany"))

with(gemini, table(Genus, useNA = "always"))

writeLines(gemini$Species, "geminiviridae-species-2023.txt")
